<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Modernize Free</title>
    <link rel="shortcut icon" type="image/png" href="../assets/images/logos/favicon.png"/>
    <link rel="stylesheet" href="/assets/css/styles.min.css"/>
</head>

<body>
<!--  Body Wrapper -->
<div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
     data-sidebar-position="fixed" data-header-position="fixed">
    <div>
        <th:block th:replace="Admin/management::aside"></th:block>
    </div>
    <div class="body-wrapper">
        <div>
            <th:block th:replace="Admin/management::header"></th:block>
        </div>
        <div class="container-fluid">
            <div class="container-fluid">
                <div class="card">
                    <div class="card-body">
                        <div class="container mt-5">
                            <!-- Movie Title -->
                            <h1 class="mb-4 text-center" th:text="${movie.title}"></h1>

                            <!-- Movie Information -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <p><strong>Năm phát hành:</strong> <span th:text="${movie.releaseYear}"></span></p>
                                </div>
                                <div class="col-md-3">
                                    <p><strong>Đạo diễn:</strong> <span th:text="${movie.director}"></span></p>
                                </div>
                                <div class="col-md-3">
                                    <p><strong>Thời lượng:</strong> <span th:text="${movie.duration}"></span> minutes
                                    </p>
                                </div>
                                <div class="col-md-3">
                                    <p><strong>Trạng thái:</strong> <span th:text="${movie.status}"></span>
                                    </p>
                                </div>

                            </div>

                            <!-- Description -->
                            <div class="mb-3">
                                <p><strong>Chi tiết phim:</strong> <span th:utext="${movie.description}"></span></p>
                            </div>
                            <div class="mb-3">
                                <p><strong>Thể loại:</strong>
                                    <span th:each="genre : ${movie.genres}"
                                          th:text="${genre.genreName} + ', '"></span>
                                </p>
                            </div>

                            <div class="mb-3">
                                <p><strong>Diễn viên:</strong>
                                    <!-- Hiển thị danh sách diễn viên nếu có -->
                                    <span th:if="${movie.actors != null and !movie.actors.isEmpty()}"
                                          th:each="actor : ${movie.actors}"
                                          th:text="${actor.actorName} + ', '"></span>
                                    <!-- Hiển thị thông báo "Đang cập nhật" nếu không có diễn viên -->
                                    <span th:unless="${movie.actors != null and !movie.actors.isEmpty()}">
                                        Đang cập nhật
                                    </span>
                                </p>
                            </div>


                            <!-- Genres -->
                            <div class="row">
                                <!-- Thể loại và Diễn viên -->

                                <!-- Tập -->
                                <div class="col-md-12 mb-4">

                                </div>
                            </div>


                            <!-- Poster and Background Images -->
                            <div class="row">
                                <div class="col-md-4 mb-4">
                                    <img th:src="@{${movie.posterUrl}}" alt="Poster" class="img-fluid custom-img-size"/>
                                </div>
                                <div class="col-md-8 mb-4">
                                    <img th:src="@{${movie.backgroundUrl}}" alt="Background"
                                         class="img-fluid custom-img-size"/>
                                </div>
                            </div>

                            <!-- Movie and Trailer Videos -->
                            <div th:if="${!movie.isSeries}" class="row mb-5">
                                <!-- Trailer -->
                                <div class="col-md-6">
                                    <p><strong>Trailer:</strong></p>
                                    <iframe th:if="${movie.trailerUrl != null and !movie.trailerUrl.isEmpty()}"
                                            th:src="${movie.trailerUrl}"
                                            width="100%" height="315"
                                            style="border-radius: 10px;"
                                            frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
                                    </iframe>
                                    <!-- Hiển thị "Chưa có" nếu URL null hoặc rỗng -->
                                    <p th:unless="${movie.trailerUrl != null and !movie.trailerUrl.isEmpty()}">
                                        Chưa có
                                    </p>
                                </div>

                                <!-- Film -->
                                <div class="col-md-6">
                                    <p><strong>Film:</strong></p>
                                    <iframe th:if="${movie.episodes != null and movie.episodes.size() > 0}"
                                            th:src="${movie.episodes[0].videoUrl}" width="100%" height="315"
                                            style="border-radius: 10px;"
                                            frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
                                    </iframe>
                                </div>
                            </div>
                            <div th:if="${movie.isSeries}" class="row mb-5">
                                <div class="col-md-6">
                                    <p><strong>Trailer:</strong></p>
                                    <!-- Hiển thị iframe nếu có URL -->
                                    <iframe th:if="${movie.trailerUrl != null and !movie.trailerUrl.isEmpty()}"
                                            th:src="${movie.trailerUrl}"
                                            width="100%" height="315"
                                            style="border-radius: 10px;"
                                            frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
                                    </iframe>
                                    <!-- Hiển thị "Chưa có" nếu URL null hoặc rỗng -->
                                    <p th:unless="${movie.trailerUrl != null and !movie.trailerUrl.isEmpty()}">
                                        Chưa có
                                    </p>
                                </div>


                                <!-- Film -->
                                <div class="col-md-6">
                                    <span> <!-- Kiểm tra nếu là phim bộ -->
                                    <a  class="btn btn-secondary btn-sm" th:href="@{/episodes/add(movieId=${movie.movieId})}">Thêm Tập</a>
                                    <div class="episode-list d-flex flex-wrap mt-3 overflow-auto" style="max-height: 315;">
                                        <a style="width: 80px" class="btn btn-outline-info btn-sm m-1"
                                           th:each="episode : ${movie.episodes}"
                                           th:href="@{/episodes/detail/{id}(id=${episode.episodeId})}"
                                           th:text="'Tập ' + ${episode.episodeNumber}"></a>
                                    </div>
                                </span>
                                </div>
                            </div>

                            <!-- Movie Status -->

                            <!-- Back Button -->
                            <div class="mt-3">
                                <a href="/movies" class="btn btn-secondary">Back to Movie List</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="/assets/libs/jquery/dist/jquery.min.js"></script>
<script src="/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="/assets/js/sidebarmenu.js"></script>
<script src="/assets/js/app.min.js"></script>
<script src="/assets/libs/simplebar/dist/simplebar.js"></script>
<style>
    .custom-img-size {
      width: 100%;
      height: 250px;  /* Đặt chiều cao cố định cho cả hai ảnh */
      object-fit: contain; /* Đảm bảo ảnh không bị cắt, giữ nguyên tỷ lệ */
  }

</style>
</body>
</html>
